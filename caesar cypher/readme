This is still incomplete, encryption works but decryption doesn't
